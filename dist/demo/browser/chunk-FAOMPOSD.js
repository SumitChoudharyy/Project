import{a as xi}from"./chunk-QRJ4QH4Z.js";import{a as Xt,c as Jt,d as _i,e as gi,f as vi,g as Ci,h as bi,i as yi,j as Si,k as xe,l as ki,m as Mi}from"./chunk-EP6J5GOL.js";import{a as ai,b as ri,c as si,d as li,e as ci,f as mi,g as pi,h as di,i as ui,j as hi,k as fi}from"./chunk-23UXKCBS.js";import{a as pe}from"./chunk-4BZ6RJX3.js";import{a as ye,b as Se,c as ke,d as Me,e as Oe}from"./chunk-TG2Z3SJJ.js";import"./chunk-NGDO4MBE.js";import{a as Zt,b as ei,c as ti,d as B,e as ii,f as ni,h as He,i as ve,j as Ce}from"./chunk-BNHOC7Z2.js";import"./chunk-JTD7WKY6.js";import{c as _e,d as ge}from"./chunk-D2LMXIO3.js";import{A as Ge,B as Wt,E as zt,H as Kt,K as Ut,M as de,N as Yt,Q as ue,S as Qt,T as he,U as fe,a as Bt,b as ne,d as A,f as oe,g as ae,j as re,k as Vt,l as se,m as le,n as $t,o as qt,q as ce,s as me,u as jt}from"./chunk-KQPGAEJR.js";import{f as Gt,g as Ht}from"./chunk-DX6TEFGM.js";import{b as we}from"./chunk-DEC6UIXC.js";import{a as Di}from"./chunk-LI7SUQZC.js";import{a as wi}from"./chunk-VS7XD6KJ.js";import{a as S,b as Oi}from"./chunk-FJOTTGA4.js";import"./chunk-TWAJJYLZ.js";import{a as oi,b as be}from"./chunk-G6WIV7NF.js";import{$ as Ie,$a as k,$b as Q,$c as qe,Aa as rt,Ba as b,D as Je,Da as st,Db as Le,Eb as R,Ec as wt,F as Ze,Fb as T,Fc as Dt,Ga as L,Gb as Be,Ha as lt,Ia as ct,La as u,Ma as V,Na as mt,Nc as Rt,Oa as pt,Oc as J,Pc as Et,R as z,Ra as Te,Rb as Ve,Rc as $e,S as K,Sc as Z,T as O,Tb as F,V as et,Xa as p,Y as tt,Ya as r,Za as a,Zb as Ct,Zc as At,_ as it,_a as y,_b as Y,ab as M,ba as f,bc as bt,cb as E,cc as yt,d as G,dc as St,e as De,ea as nt,eb as _,fa as g,fb as C,fc as X,g as I,ga as v,gb as dt,hb as ut,hd as It,ib as Fe,id as Pt,ja as U,jb as Ne,kb as $,kd as je,lb as q,md as ee,n as Re,nd as te,od as Tt,pb as P,pd as ie,q as Ee,qd as Ft,rb as ht,rc as kt,s as H,sa as ot,sb as ft,sd as Nt,tb as s,u as Xe,ua as Pe,ub as x,uc as Mt,vb as D,vc as Ot,wb as _t,wc as xt,wd as Lt,x as W,xa as c,xb as gt,y as Ae,ya as at,yb as vt}from"./chunk-MA7RV5JZ.js";var qi=["panel"],ji=["*"];function Gi(n,l){if(n&1&&(r(0,"div",1,0),ut(2),a()),n&2){let t=l.id,e=C();ft(e._classList),ht("mat-mdc-autocomplete-visible",e.showPanel)("mat-mdc-autocomplete-hidden",!e.showPanel)("mat-autocomplete-panel-animations-enabled",!e._animationsDisabled)("mat-primary",e._color==="primary")("mat-accent",e._color==="accent")("mat-warn",e._color==="warn"),p("id",e.id),Te("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby(t))}}var We=class{source;option;constructor(l,t){this.source=l,this.option=t}},Ii=new Ie("mat-autocomplete-default-options",{providedIn:"root",factory:Hi});function Hi(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1,hasBackdrop:!1}}var Pi=(()=>{class n{_changeDetectorRef=f(Ve);_elementRef=f(Pe);_defaults=f(Ii);_animationsDisabled=qe();_activeOptionChanges=G.EMPTY;_keyManager;showPanel=!1;get isOpen(){return this._isOpen&&this.showPanel}_isOpen=!1;_latestOpeningTrigger;_setColor(t){this._color=t,this._changeDetectorRef.markForCheck()}_color;template;panel;options;optionGroups;ariaLabel;ariaLabelledby;displayWith=null;autoActiveFirstOption;autoSelectActiveOption;requireSelection;panelWidth;disableRipple;optionSelected=new V;opened=new V;closed=new V;optionActivated=new V;set classList(t){this._classList=t,this._elementRef.nativeElement.className=""}_classList;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._syncParentProperties()}_hideSingleSelectionIndicator;_syncParentProperties(){if(this.options)for(let t of this.options)t._changeDetectorRef.markForCheck()}id=f(Rt).getId("mat-autocomplete-");inertGroups;constructor(){let t=f(xt);this.inertGroups=t?.SAFARI||!1,this.autoActiveFirstOption=!!this._defaults.autoActiveFirstOption,this.autoSelectActiveOption=!!this._defaults.autoSelectActiveOption,this.requireSelection=!!this._defaults.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new Et(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options?.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){let e=new We(this,t);this.optionSelected.emit(e)}_getPanelAriaLabelledby(t){if(this.ariaLabel)return null;let e=t?t+" ":"";return this.ariaLabelledby?e+this.ariaLabelledby:t}_skipPredicate(){return!1}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=L({type:n,selectors:[["mat-autocomplete"]],contentQueries:function(e,i,o){if(e&1&&(Fe(o,B,5),Fe(o,ei,5)),e&2){let m;$(m=q())&&(i.options=m),$(m=q())&&(i.optionGroups=m)}},viewQuery:function(e,i){if(e&1&&(Ne(at,7),Ne(qi,5)),e&2){let o;$(o=q())&&(i.template=o.first),$(o=q())&&(i.panel=o.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[2,"autoActiveFirstOption","autoActiveFirstOption",F],autoSelectActiveOption:[2,"autoSelectActiveOption","autoSelectActiveOption",F],requireSelection:[2,"requireSelection","requireSelection",F],panelWidth:"panelWidth",disableRipple:[2,"disableRipple","disableRipple",F],classList:[0,"class","classList"],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",F]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],features:[Le([{provide:Zt,useExisting:n}])],ngContentSelectors:ji,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(e,i){e&1&&(dt(),u(0,Gi,3,17,"ng-template"))},styles:[`div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:relative;border-radius:var(--mat-autocomplete-container-shape, var(--mat-sys-corner-extra-small));box-shadow:var(--mat-autocomplete-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));background-color:var(--mat-autocomplete-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-autocomplete-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}@keyframes _mat-autocomplete-enter{from{opacity:0;transform:scaleY(0.8)}to{opacity:1;transform:none}}.mat-autocomplete-panel-animations-enabled{animation:_mat-autocomplete-enter 120ms cubic-bezier(0, 0, 0.2, 1)}mat-autocomplete{display:none}
`],encapsulation:2,changeDetection:0})}return n})();var Wi={provide:Bt,useExisting:tt(()=>ze),multi:!0};var Ti=new Ie("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let n=f(U);return()=>Ge(n)}});function zi(n){let l=f(U);return()=>Ge(l)}var Ki={provide:Ti,deps:[],useFactory:zi},ze=(()=>{class n{_environmentInjector=f(nt);_element=f(Pe);_injector=f(U);_viewContainerRef=f(st);_zone=f(mt);_changeDetectorRef=f(Ve);_dir=f(Pt,{optional:!0});_formField=f(Qt,{optional:!0,host:!0});_viewportRuler=f(Gt);_scrollStrategy=f(Ti);_renderer=f(rt);_animationsDisabled=qe();_defaults=f(Ii,{optional:!0});_overlayRef;_portal;_componentDestroyed=!1;_initialized=new I;_keydownSubscription;_outsideClickSubscription;_cleanupWindowBlur;_previousValue;_valueOnAttach;_valueOnLastKeydown;_positionStrategy;_manuallyFloatingLabel=!1;_closingActionsSubscription;_viewportSubscription=G.EMPTY;_breakpointObserver=f(Dt);_handsetLandscapeSubscription=G.EMPTY;_canOpenOnNextFocus=!0;_valueBeforeAutoSelection;_pendingAutoselectedOption;_closeKeyEventStream=new I;_overlayPanelClass=wt(this._defaults?.overlayPanelClass||[]);_windowBlurHandler=()=>{this._canOpenOnNextFocus=this.panelOpen||!this._hasFocus()};_onChange=()=>{};_onTouched=()=>{};autocomplete;position="auto";connectedTo;autocompleteAttribute="off";autocompleteDisabled;constructor(){}_aboveClass="mat-mdc-autocomplete-panel-above";ngAfterViewInit(){this._initialized.next(),this._initialized.complete(),this._cleanupWindowBlur=this._renderer.listen("window","blur",this._windowBlurHandler)}ngOnChanges(t){t.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){this._cleanupWindowBlur?.(),this._handsetLandscapeSubscription.unsubscribe(),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}_overlayAttached=!1;openPanel(){this._openPanelInternal()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._latestOpeningTrigger===this&&(this.autocomplete._isOpen=!1,this.autocomplete._latestOpeningTrigger=null),this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal&&Z(this._trackedModal,"aria-owns",this.autocomplete.id))}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return W(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(Ae(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(Ae(()=>this._overlayAttached)):Re()).pipe(H(t=>t instanceof ti?t:null))}optionSelections=Xe(()=>{let t=this.autocomplete?this.autocomplete.options:null;return t?t.changes.pipe(z(t),K(()=>W(...t.map(e=>e.onSelectionChange)))):this._initialized.pipe(K(()=>this.optionSelections))});get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return new De(t=>{let e=o=>{let m=Ot(o),d=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,h=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;this._overlayAttached&&m!==this._element.nativeElement&&!this._hasFocus()&&(!d||!d.contains(m))&&(!h||!h.contains(m))&&this._overlayRef&&!this._overlayRef.overlayElement.contains(m)&&t.next(o)},i=[this._renderer.listen("document","click",e),this._renderer.listen("document","auxclick",e),this._renderer.listen("document","touchend",e)];return()=>{i.forEach(o=>o())}})}writeValue(t){Promise.resolve(null).then(()=>this._assignOptionValue(t))}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this._element.nativeElement.disabled=t}_handleKeydown(t){let e=t,i=e.keyCode,o=J(e);if(i===27&&!o&&e.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&i===13&&this.panelOpen&&!o)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){let m=this.autocomplete._keyManager.activeItem,d=i===38||i===40;i===9||d&&!o&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):d&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(d||this.autocomplete._keyManager.activeItem!==m)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(t){let e=t.target,i=e.value;if(e.type==="number"&&(i=i==""?null:parseFloat(i)),this._previousValue!==i){if(this._previousValue=i,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(i),!i)this._clearPreviousSelectedOption(null,!1);else if(this.panelOpen&&!this.autocomplete.requireSelection){let o=this.autocomplete.options?.find(m=>m.selected);if(o){let m=this._getDisplayValue(o.value);i!==m&&o.deselect(!1)}}if(this._canOpen()&&this._hasFocus()){let o=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(o)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_hasFocus(){return Mt()===this._element.nativeElement}_floatLabel(t=!1){this._formField&&this._formField.floatLabel==="auto"&&(t?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){let t=new De(i=>{pt(()=>{i.next()},{injector:this._environmentInjector})}),e=this.autocomplete.options?.changes.pipe(et(()=>this._positionStrategy.reapplyLastPosition()),Ze(0))??Re();return W(t,e).pipe(K(()=>this._zone.run(()=>{let i=this.panelOpen;return this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),i!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit()),this.panelClosingActions})),Je(1)).subscribe(i=>this._setValueAndClose(i))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(t){let e=this.autocomplete;return e&&e.displayWith?e.displayWith(t):t}_assignOptionValue(t){let e=this._getDisplayValue(t);t==null&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(e??"")}_updateNativeInputValue(t){this._formField?this._formField._control.value=t:this._element.nativeElement.value=t,this._previousValue=t}_setValueAndClose(t){let e=this.autocomplete,i=t?t.source:this._pendingAutoselectedOption;i?(this._clearPreviousSelectedOption(i),this._assignOptionValue(i.value),this._onChange(i.value),e._emitSelectEvent(i),this._element.nativeElement.focus()):e.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(t,e){this.autocomplete?.options?.forEach(i=>{i!==t&&i.selected&&i.deselect(e)})}_openPanelInternal(t=this._element.nativeElement.value){if(this._attachOverlay(t),this._floatLabel(),this._trackedModal){let e=this.autocomplete.id;$e(this._trackedModal,"aria-owns",e)}}_attachOverlay(t){this.autocomplete;let e=this._overlayRef;e?(this._positionStrategy.setOrigin(this._getConnectedElement()),e.updateSize({width:this._getPanelWidth()})):(this._portal=new jt(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),e=Kt(this._injector,this._getOverlayConfig()),this._overlayRef=e,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&e&&e.updateSize({width:this._getPanelWidth()})}),this._handsetLandscapeSubscription=this._breakpointObserver.observe(At.HandsetLandscape).subscribe(o=>{o.matches?this._positionStrategy.withFlexibleDimensions(!0).withGrowAfterOpen(!0).withViewportMargin(8):this._positionStrategy.withFlexibleDimensions(!1).withGrowAfterOpen(!1).withViewportMargin(0)})),e&&!e.hasAttached()&&(e.attach(this._portal),this._valueOnAttach=t,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());let i=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._latestOpeningTrigger=this,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&i!==this.panelOpen&&this._emitOpened()}_handlePanelKeydown=t=>{(t.keyCode===27&&!J(t)||t.keyCode===38&&J(t,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),t.stopPropagation(),t.preventDefault())};_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){let t=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=t.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=t.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new Wt({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,hasBackdrop:this._defaults?.hasBackdrop,backdropClass:this._defaults?.backdropClass,panelClass:this._overlayPanelClass,disableAnimations:this._animationsDisabled})}_getOverlayPosition(){let t=zt(this._injector,this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(t),this._positionStrategy=t,t}_setStrategyPositions(t){let e=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],i=this._aboveClass,o=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:i},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:i}],m;this.position==="above"?m=o:this.position==="below"?m=e:m=[...e,...o],t.withPositions(m)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){let t=this.autocomplete;if(t.autoActiveFirstOption){let e=-1;for(let i=0;i<t.options.length;i++)if(!t.options.get(i).disabled){e=i;break}t._keyManager.setActiveItem(e)}else t._keyManager.setActiveItem(-1)}_canOpen(){let t=this._element.nativeElement;return!t.readOnly&&!t.disabled&&!this.autocompleteDisabled}_scrollToOption(t){let e=this.autocomplete,i=ii(t,e.options,e.optionGroups);if(t===0&&i===1)e._setScrollTop(0);else if(e.panel){let o=e.options.toArray()[t];if(o){let m=o._getHostElement(),d=ni(m.offsetTop,m.offsetHeight,e._getScrollTop(),e.panel.nativeElement.offsetHeight);e._setScrollTop(d)}}}_trackedModal=null;_applyModalPanelOwnership(){let t=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!t)return;let e=this.autocomplete.id;this._trackedModal&&Z(this._trackedModal,"aria-owns",e),$e(t,"aria-owns",e),this._trackedModal=t}_clearFromModal(){if(this._trackedModal){let t=this.autocomplete.id;Z(this._trackedModal,"aria-owns",t),this._trackedModal=null}}static \u0275fac=function(e){return new(e||n)};static \u0275dir=ct({type:n,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(e,i){e&1&&_("focusin",function(){return i._handleFocus()})("blur",function(){return i._onTouched()})("input",function(m){return i._handleInput(m)})("keydown",function(m){return i._handleKeydown(m)})("click",function(){return i._handleClick()}),e&2&&Te("autocomplete",i.autocompleteAttribute)("role",i.autocompleteDisabled?null:"combobox")("aria-autocomplete",i.autocompleteDisabled?null:"list")("aria-activedescendant",i.panelOpen&&i.activeOption?i.activeOption.id:null)("aria-expanded",i.autocompleteDisabled?null:i.panelOpen.toString())("aria-controls",i.autocompleteDisabled||!i.panelOpen||i.autocomplete==null?null:i.autocomplete.id)("aria-haspopup",i.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[0,"matAutocomplete","autocomplete"],position:[0,"matAutocompletePosition","position"],connectedTo:[0,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[0,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[2,"matAutocompleteDisabled","autocompleteDisabled",F]},exportAs:["matAutocompleteTrigger"],features:[Le([Wi]),ot]})}return n})(),Fi=(()=>{class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=lt({type:n});static \u0275inj=it({providers:[Ki],imports:[Ut,He,je,Ht,He,je]})}return n})();function rn(n,l){if(n&1&&(r(0,"mat-option",23),s(1),a()),n&2){let t=l.$implicit;p("value",t.email),c(),gt(" ",t.firstName," ",t.lastName," (",t.email,") ")}}function sn(n,l){n&1&&(r(0,"mat-error"),s(1," Customer email is required "),a())}function ln(n,l){n&1&&(r(0,"mat-error"),s(1," Please enter a valid email "),a())}function cn(n,l){if(n&1&&(r(0,"mat-option",23),s(1),a()),n&2){let t=l.$implicit;p("value",t.id),c(),vt(" ",t.roomNumber," - ",t.category," (",t.capacity," guests) - $",t.pricePerNight,"/night ")}}function mn(n,l){n&1&&(r(0,"mat-error"),s(1," Room selection is required "),a())}function pn(n,l){n&1&&(r(0,"mat-error"),s(1," Check-in date is required "),a())}function dn(n,l){n&1&&(r(0,"mat-error"),s(1," Check-out date is required "),a())}function un(n,l){n&1&&(r(0,"mat-error"),s(1," Number of guests is required "),a())}function hn(n,l){n&1&&(r(0,"mat-error"),s(1," At least 1 guest is required "),a())}function fn(n,l){if(n&1&&(r(0,"div",24)(1,"h4"),s(2,"Booking Summary"),a(),r(3,"div",25)(4,"span"),s(5,"Room:"),a(),r(6,"span"),s(7),a()(),r(8,"div",25)(9,"span"),s(10,"Duration:"),a(),r(11,"span"),s(12),a()(),r(13,"div",25)(14,"span"),s(15,"Total Amount:"),a(),r(16,"span",26),s(17),a()()()),n&2){let t=C();c(7),_t("",t.selectedRoom.roomNumber," - ",t.selectedRoom.category),c(5),D("",t.getDurationDays()," nights"),c(5),D("$",t.calculateTotalAmount())}}function _n(n,l){n&1&&y(0,"mat-spinner",27)}function gn(n,l){n&1&&(r(0,"span"),s(1,"Create Reservation"),a())}var Ni=(()=>{let l=class l{constructor(e,i,o,m,d,h){this.fb=e,this.dialogRef=i,this.roomService=o,this.bookingService=m,this.snackBar=d,this.data=h,this.availableRooms=[],this.customers=[],this.selectedRoom=null,this.isSubmitting=!1,this.destroy$=new I,this.reservationForm=this.fb.group({customerEmail:["",[A.required,A.email]],roomId:["",A.required],checkInDate:["",A.required],checkOutDate:["",A.required],guests:[1,[A.required,A.min(1)]],specialRequests:[""]}),this.filteredCustomers$=this.reservationForm.get("customerEmail").valueChanges.pipe(z(""),H(N=>this.filterCustomers(N)))}ngOnInit(){this.loadAvailableRooms(),this.loadCustomers(),this.setupFormListeners()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAvailableRooms(){this.roomService.getAvailableRooms().pipe(O(this.destroy$)).subscribe({next:e=>{this.availableRooms=e,this.selectedRoom&&this.updateSelectedRoom()},error:e=>{console.error("Error loading available rooms:",e),this.snackBar.open("Failed to load available rooms","Close",{duration:3e3})}})}updateSelectedRoom(){let e=this.reservationForm.get("roomId").value;this.selectedRoom=this.availableRooms.find(i=>i.id===e)||null}loadCustomers(){this.customers=[{id:"1",email:"john.doe@example.com",firstName:"John",lastName:"Doe",phoneNumber:"+1234567890",address:{street:"123 Main St",city:"New York",state:"NY",zipCode:"10001",country:"USA"},role:"customer",isActive:!0,createdAt:new Date,loginAttempts:0,isLocked:!1},{id:"2",email:"jane.smith@example.com",firstName:"Jane",lastName:"Smith",phoneNumber:"+1234567891",address:{street:"456 Oak Ave",city:"Los Angeles",state:"CA",zipCode:"90210",country:"USA"},role:"customer",isActive:!0,createdAt:new Date,loginAttempts:0,isLocked:!1},{id:"3",email:"mike.johnson@example.com",firstName:"Mike",lastName:"Johnson",phoneNumber:"+1234567892",address:{street:"789 Pine St",city:"Chicago",state:"IL",zipCode:"60601",country:"USA"},role:"customer",isActive:!0,createdAt:new Date,loginAttempts:0,isLocked:!1}]}setupFormListeners(){this.reservationForm.get("roomId").valueChanges.pipe(O(this.destroy$)).subscribe(e=>{this.selectedRoom=this.availableRooms.find(i=>i.id===e)||null}),this.reservationForm.get("checkInDate").valueChanges.pipe(O(this.destroy$)).subscribe(()=>{this.validateDates()}),this.reservationForm.get("checkOutDate").valueChanges.pipe(O(this.destroy$)).subscribe(()=>{this.validateDates()})}validateDates(){let e=this.reservationForm.get("checkInDate").value,i=this.reservationForm.get("checkOutDate").value;e&&i&&e>=i?this.reservationForm.get("checkOutDate").setErrors({invalidDateRange:!0}):this.reservationForm.get("checkOutDate").setErrors(null)}filterCustomers(e){let i=e.toLowerCase();return this.customers.filter(o=>o.email.toLowerCase().includes(i)||o.firstName.toLowerCase().includes(i)||o.lastName.toLowerCase().includes(i))}onCustomerSelected(e){let i=this.customers.find(o=>o.email===e.option.value);i&&console.log("Selected customer:",i)}getDurationDays(){let e=this.reservationForm.get("checkInDate").value,i=this.reservationForm.get("checkOutDate").value;if(e&&i){let o=Math.abs(i.getTime()-e.getTime());return Math.ceil(o/(1e3*60*60*24))}return 0}calculateTotalAmount(){if(!this.selectedRoom)return 0;let e=this.getDurationDays();return this.selectedRoom.pricePerNight*e}onSubmit(){if(this.reservationForm.invalid)return;this.isSubmitting=!0;let e=this.reservationForm.value,i=this.customers.find(w=>w.email===e.customerEmail);if(!i){this.snackBar.open("Please select a valid customer","Close",{duration:3e3}),this.isSubmitting=!1;return}let o=this.availableRooms.find(w=>w.id===e.roomId);if(o&&e.guests>o.capacity){this.snackBar.open(`Room capacity is ${o.capacity} guests. Please select a different room or reduce guest count.`,"Close",{duration:5e3}),this.isSubmitting=!1;return}let m=new Date(e.checkInDate),d=new Date(e.checkOutDate),h=new Date;if(h.setHours(0,0,0,0),m<h){this.snackBar.open("Check-in date cannot be in the past","Close",{duration:3e3}),this.isSubmitting=!1;return}if(d<=m){this.snackBar.open("Check-out date must be after check-in date","Close",{duration:3e3}),this.isSubmitting=!1;return}let N={roomId:e.roomId,checkInDate:e.checkInDate,checkOutDate:e.checkOutDate,guests:e.guests,specialRequests:e.specialRequests};this.bookingService.createBooking(i.id,N).pipe(O(this.destroy$)).subscribe({next:w=>{this.snackBar.open("Reservation created successfully!","Close",{duration:3e3}),this.dialogRef.close(w)},error:w=>{console.error("Error creating reservation:",w),this.snackBar.open("Failed to create reservation. Please try again.","Close",{duration:3e3}),this.isSubmitting=!1}})}};l.\u0275fac=function(i){return new(i||l)(b(ce),b(_i),b(Di),b(we),b(pe),b(gi))},l.\u0275cmp=L({type:l,selectors:[["app-new-reservation-dialog"]],decls:58,vars:21,consts:[["customerAuto","matAutocomplete"],["checkInPicker",""],["checkOutPicker",""],[1,"new-reservation-dialog"],["mat-dialog-title",""],[3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-field"],["type","email","matInput","","formControlName","customerEmail","placeholder","Enter customer email",3,"matAutocomplete"],[3,"optionSelected"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","roomId","required",""],["matInput","","formControlName","checkInDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","checkOutDate","required","",3,"matDatepicker"],["type","number","matInput","","formControlName","guests","min","1","required",""],["matInput","","formControlName","specialRequests","rows","3","placeholder","Any special requests or notes"],["class","booking-summary",4,"ngIf"],["align","end"],["type","button","mat-button","","mat-dialog-close",""],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["diameter","20",4,"ngIf"],[3,"value"],[1,"booking-summary"],[1,"summary-item"],[1,"total-amount"],["diameter","20"]],template:function(i,o){if(i&1){let m=E();r(0,"div",3)(1,"h2",4),s(2,"Create New Reservation"),a(),r(3,"form",5),_("ngSubmit",function(){return g(m),v(o.onSubmit())}),r(4,"mat-dialog-content")(5,"div",6)(6,"mat-form-field",7)(7,"mat-label"),s(8,"Customer Email"),a(),y(9,"input",8),r(10,"mat-autocomplete",9,0),_("optionSelected",function(h){return g(m),v(o.onCustomerSelected(h))}),u(12,rn,2,4,"mat-option",10),R(13,"async"),a(),u(14,sn,2,0,"mat-error",11)(15,ln,2,0,"mat-error",11),a()(),r(16,"div",6)(17,"mat-form-field",7)(18,"mat-label"),s(19,"Room"),a(),r(20,"mat-select",12),u(21,cn,2,5,"mat-option",10),a(),u(22,mn,2,0,"mat-error",11),a()(),r(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),s(26,"Check-in Date"),a(),y(27,"input",13)(28,"mat-datepicker-toggle",14)(29,"mat-datepicker",null,1),u(31,pn,2,0,"mat-error",11),a(),r(32,"mat-form-field",7)(33,"mat-label"),s(34,"Check-out Date"),a(),y(35,"input",15)(36,"mat-datepicker-toggle",14)(37,"mat-datepicker",null,2),u(39,dn,2,0,"mat-error",11),a()(),r(40,"div",6)(41,"mat-form-field",7)(42,"mat-label"),s(43,"Number of Guests"),a(),y(44,"input",16),u(45,un,2,0,"mat-error",11)(46,hn,2,0,"mat-error",11),a(),r(47,"mat-form-field",7)(48,"mat-label"),s(49,"Special Requests"),a(),y(50,"textarea",17),a()(),u(51,fn,18,4,"div",18),a(),r(52,"mat-dialog-actions",19)(53,"button",20),s(54,"Cancel"),a(),r(55,"button",21),u(56,_n,1,0,"mat-spinner",22)(57,gn,2,0,"span",11),a()()()()}if(i&2){let m,d,h,N,w,Ke,Ue,j,Li=P(11),Ye=P(30),Qe=P(38);c(3),p("formGroup",o.reservationForm),c(6),p("matAutocomplete",Li),c(3),p("ngForOf",T(13,19,o.filteredCustomers$)),c(2),p("ngIf",(m=o.reservationForm.get("customerEmail"))==null?null:m.hasError("required")),c(),p("ngIf",(d=o.reservationForm.get("customerEmail"))==null?null:d.hasError("email")),c(6),p("ngForOf",o.availableRooms),c(),p("ngIf",(h=o.reservationForm.get("roomId"))==null?null:h.hasError("required")),c(5),p("matDatepicker",Ye),c(),p("for",Ye),c(3),p("ngIf",(N=o.reservationForm.get("checkInDate"))==null?null:N.hasError("required")),c(4),p("matDatepicker",Qe),c(),p("for",Qe),c(3),p("ngIf",(w=o.reservationForm.get("checkOutDate"))==null?null:w.hasError("required")),c(6),p("ngIf",(Ke=o.reservationForm.get("guests"))==null?null:Ke.hasError("required")),c(),p("ngIf",(Ue=o.reservationForm.get("guests"))==null?null:Ue.hasError("min")),c(5),p("ngIf",o.selectedRoom&&((j=o.reservationForm.get("checkInDate"))==null?null:j.value)&&((j=o.reservationForm.get("checkOutDate"))==null?null:j.value)),c(4),p("disabled",o.reservationForm.invalid||o.isSubmitting),c(),p("ngIf",o.isSubmitting),c(),p("ngIf",!o.isSubmitting)}},dependencies:[X,Y,Q,bt,me,re,ne,Vt,oe,ae,qt,$t,se,le,xe,Ci,bi,Si,yi,fe,he,de,Yt,ue,ge,_e,Ce,ve,B,Fi,Pi,ze,Me,ye,Se,ke,Oe,te,ee,ie,be,oi],styles:[".new-reservation-dialog[_ngcontent-%COMP%]{min-width:500px;max-width:600px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.form-field[_ngcontent-%COMP%]{flex:1}.booking-summary[_ngcontent-%COMP%]{margin-top:24px;padding:16px;background-color:#f5f5f5;border-radius:8px}.booking-summary[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#1976d2}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.total-amount[_ngcontent-%COMP%]{font-weight:700;color:#1976d2;font-size:18px}@media (max-width: 600px){.new-reservation-dialog[_ngcontent-%COMP%]{min-width:100%;max-width:100%}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:8px}}"]});let n=l;return n})();function vn(n,l){if(n&1&&(r(0,"mat-option",26),s(1),R(2,"titlecase"),a()),n&2){let t=l.$implicit;p("value",t),c(),D(" ",T(2,2,t)," ")}}function Cn(n,l){if(n&1&&(r(0,"mat-option",26),s(1),R(2,"titlecase"),a()),n&2){let t=l.$implicit;p("value",t),c(),D(" ",T(2,2,t)," ")}}function bn(n,l){n&1&&(r(0,"div",27),y(1,"app-loading-spinner",28),a())}function yn(n,l){n&1&&(r(0,"div",29)(1,"mat-icon"),s(2,"event_busy"),a(),r(3,"h3"),s(4,"No reservations found"),a(),r(5,"p"),s(6,"No reservations match your current filters"),a()())}function Sn(n,l){if(n&1){let t=E();r(0,"div",48)(1,"span",49),s(2),a(),r(3,"button",21),_("click",function(){g(t);let i=C(2);return v(i.bulkConfirm())}),r(4,"mat-icon"),s(5,"check_circle"),a(),s(6," Confirm Selected "),a(),r(7,"button",50),_("click",function(){g(t);let i=C(2);return v(i.bulkCancel())}),r(8,"mat-icon"),s(9,"cancel"),a(),s(10," Cancel Selected "),a()()}if(n&2){let t=C(2);c(2),D("",t.selectedCount," booking(s) selected"),c(),p("disabled",!t.canBulkConfirm())}}function kn(n,l){if(n&1){let t=E();r(0,"th",51)(1,"mat-checkbox",52),_("change",function(i){g(t);let o=C(2);return v(i?o.masterToggle():null)}),a()()}if(n&2){let t=C(2);c(),p("checked",t.isAllSelected)("indeterminate",!t.isAllSelected&&t.selectedCount>0)}}function Mn(n,l){if(n&1){let t=E();r(0,"td",53)(1,"mat-checkbox",54),_("click",function(i){return g(t),v(i.stopPropagation())})("change",function(i){let o=g(t).$implicit,m=C(2);return v(m.onSelectionChange(o.id,i.checked))}),a()()}if(n&2){let t=l.$implicit,e=C(2);c(),p("checked",e.selection.has(t.id))("disabled",!e.canSelect(t))}}function On(n,l){n&1&&(r(0,"th",51),s(1,"Booking ID"),a())}function xn(n,l){if(n&1&&(r(0,"td",53),s(1),a()),n&2){let t=l.$implicit;c(),x(t.id)}}function wn(n,l){n&1&&(r(0,"th",51),s(1,"Customer ID"),a())}function Dn(n,l){if(n&1&&(r(0,"td",53),s(1),a()),n&2){let t=l.$implicit;c(),x(t.customerId)}}function Rn(n,l){n&1&&(r(0,"th",51),s(1,"Room ID"),a())}function En(n,l){if(n&1&&(r(0,"td",53),s(1),a()),n&2){let t=l.$implicit;c(),x(t.roomId)}}function An(n,l){n&1&&(r(0,"th",51),s(1,"Check-in"),a())}function In(n,l){if(n&1&&(r(0,"td",53),s(1),R(2,"date"),a()),n&2){let t=l.$implicit;c(),x(Be(2,1,t.checkInDate,"shortDate"))}}function Pn(n,l){n&1&&(r(0,"th",51),s(1,"Check-out"),a())}function Tn(n,l){if(n&1&&(r(0,"td",53),s(1),R(2,"date"),a()),n&2){let t=l.$implicit;c(),x(Be(2,1,t.checkOutDate,"shortDate"))}}function Fn(n,l){n&1&&(r(0,"th",51),s(1,"Guests"),a())}function Nn(n,l){if(n&1&&(r(0,"td",53),s(1),a()),n&2){let t=l.$implicit;c(),x(t.guests)}}function Ln(n,l){n&1&&(r(0,"th",51),s(1,"Status"),a())}function Bn(n,l){if(n&1&&(r(0,"td",53)(1,"mat-chip",55),s(2),R(3,"titlecase"),a()()),n&2){let t=l.$implicit;c(),p("ngClass","status-"+t.status),c(),D(" ",T(3,2,t.status)," ")}}function Vn(n,l){n&1&&(r(0,"th",51),s(1,"Payment"),a())}function $n(n,l){if(n&1&&(r(0,"td",53)(1,"mat-chip",55),s(2),R(3,"titlecase"),a()()),n&2){let t=l.$implicit;c(),p("ngClass","payment-"+t.paymentStatus),c(),D(" ",T(3,2,t.paymentStatus)," ")}}function qn(n,l){n&1&&(r(0,"th",51),s(1,"Total"),a())}function jn(n,l){if(n&1&&(r(0,"td",53),s(1),a()),n&2){let t=l.$implicit;c(),D("$",t.totalAmount)}}function Gn(n,l){n&1&&(r(0,"th",51),s(1,"Actions"),a())}function Hn(n,l){if(n&1){let t=E();r(0,"td",53)(1,"div",56)(2,"button",57),_("click",function(){let i=g(t).$implicit,o=C(2);return v(o.viewBookingDetails(i))}),r(3,"mat-icon"),s(4,"visibility"),a()(),r(5,"button",58),_("click",function(){let i=g(t).$implicit,o=C(2);return v(o.editBooking(i))}),r(6,"mat-icon"),s(7,"edit"),a()(),r(8,"button",59),_("click",function(){let i=g(t).$implicit,o=C(2);return v(o.cancelBooking(i))}),r(9,"mat-icon"),s(10,"cancel"),a()()()()}}function Wn(n,l){n&1&&y(0,"tr",60)}function zn(n,l){n&1&&y(0,"tr",61)}function Kn(n,l){if(n&1&&(r(0,"div",30),u(1,Sn,11,2,"div",31),r(2,"table",32),k(3,33),u(4,kn,2,2,"th",34)(5,Mn,2,2,"td",35),M(),k(6,36),u(7,On,2,0,"th",34)(8,xn,2,1,"td",35),M(),k(9,37),u(10,wn,2,0,"th",34)(11,Dn,2,1,"td",35),M(),k(12,38),u(13,Rn,2,0,"th",34)(14,En,2,1,"td",35),M(),k(15,39),u(16,An,2,0,"th",34)(17,In,3,4,"td",35),M(),k(18,40),u(19,Pn,2,0,"th",34)(20,Tn,3,4,"td",35),M(),k(21,41),u(22,Fn,2,0,"th",34)(23,Nn,2,1,"td",35),M(),k(24,42),u(25,Ln,2,0,"th",34)(26,Bn,4,4,"td",35),M(),k(27,43),u(28,Vn,2,0,"th",34)(29,$n,4,4,"td",35),M(),k(30,44),u(31,qn,2,0,"th",34)(32,jn,2,1,"td",35),M(),k(33,45),u(34,Gn,2,0,"th",34)(35,Hn,11,0,"td",35),M(),u(36,Wn,1,0,"tr",46)(37,zn,1,0,"tr",47),a()()),n&2){let t=C();c(),p("ngIf",t.selectedCount>0),c(),p("dataSource",t.filteredReservations),c(34),p("matHeaderRowDef",t.displayedColumns),c(),p("matRowDefColumns",t.displayedColumns)}}var ma=(()=>{let l=class l{constructor(e,i,o,m,d){this.bookingService=e,this.fb=i,this.dialog=o,this.snackBar=m,this.popupService=d,this.allReservations=[],this.filteredReservations=[],this.isLoading=!1,this.displayedColumns=["select","id","customerId","roomId","checkInDate","checkOutDate","guests","status","paymentStatus","totalAmount","actions"],this.stats={active:0,pending:0,completed:0,cancelled:0},this.selection=new Map,this.isAllSelected=!1,this.selectedCount=0,this.bookingStatuses=Object.values(S),this.paymentStatuses=Object.values(Oi),this.destroy$=new I,this.filterForm=this.fb.group({status:[""],paymentStatus:[""],startDate:[""],endDate:[""]})}ngOnInit(){this.loadReservations(),this.setupFilterListeners()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadReservations(){this.isLoading=!0,this.bookingService.getAllBookings().pipe(O(this.destroy$)).subscribe({next:e=>{this.allReservations=e,this.filteredReservations=e,this.updateStats(),this.isLoading=!1,this.selection.clear(),this.selectedCount=0,this.isAllSelected=!1},error:e=>{console.error("Error loading reservations:",e),this.snackBar.open("Failed to load reservations","Close",{duration:3e3}),this.isLoading=!1}})}setupFilterListeners(){this.filterForm.valueChanges.pipe(O(this.destroy$)).subscribe(()=>{this.applyFilters()})}updateStats(){let e=new Date;this.stats.active=this.allReservations.filter(i=>new Date(i.checkInDate)<=e&&new Date(i.checkOutDate)>e&&i.status===S.CONFIRMED).length,this.stats.pending=this.allReservations.filter(i=>i.status===S.PENDING).length,this.stats.completed=this.allReservations.filter(i=>i.status===S.CHECKED_OUT).length,this.stats.cancelled=this.allReservations.filter(i=>i.status===S.CANCELLED).length}applyFilters(){let e=this.filterForm.value;this.filteredReservations=this.allReservations.filter(i=>{let o=!0;return e.status&&i.status!==e.status&&(o=!1),e.paymentStatus&&i.paymentStatus!==e.paymentStatus&&(o=!1),e.startDate&&new Date(i.checkInDate)<new Date(e.startDate)&&(o=!1),e.endDate&&new Date(i.checkOutDate)>new Date(e.endDate)&&(o=!1),o}),this.selection.clear(),this.selectedCount=0,this.isAllSelected=!1}refreshReservations(){this.loadReservations()}openNewReservationDialog(){this.dialog.open(Ni,{width:"600px",maxWidth:"90vw",disableClose:!0}).afterClosed().pipe(O(this.destroy$)).subscribe(i=>{i&&(this.loadReservations(),this.snackBar.open("New reservation created successfully!","Close",{duration:3e3}))})}viewBookingDetails(e){console.log("View booking details:",e)}editBooking(e){console.log("Edit booking:",e)}cancelBooking(e){this.popupService.confirmDanger(`Are you sure you want to cancel booking #${e.id}?`,"Cancel Booking").subscribe(i=>{i&&this.bookingService.cancelBooking(e.id,"Cancelled by admin").pipe(O(this.destroy$)).subscribe({next:o=>{this.snackBar.open("Booking cancelled successfully","Close",{duration:3e3}),this.loadReservations()},error:o=>{console.error("Error cancelling booking:",o),this.snackBar.open("Failed to cancel booking","Close",{duration:3e3})}})})}masterToggle(){this.isAllSelected?(this.selection.clear(),this.selectedCount=0):(this.filteredReservations.forEach(e=>{this.canSelect(e)&&this.selection.set(e.id,!0)}),this.selectedCount=this.selection.size),this.isAllSelected=!this.isAllSelected}canSelect(e){return e.status===S.PENDING||e.status===S.CONFIRMED}canBulkConfirm(){return Array.from(this.selection.keys()).some(e=>{let i=this.filteredReservations.find(o=>o.id===e);return i&&i.status===S.PENDING})}bulkConfirm(){let e=this.filteredReservations.filter(i=>this.selection.has(i.id)&&i.status===S.PENDING);if(e.length===0){this.snackBar.open("No pending bookings selected for confirmation","Close",{duration:3e3});return}this.popupService.confirmSimple(`Confirm ${e.length} pending booking(s)?`,"Bulk Confirm Bookings").subscribe(i=>{i&&this.processBulkConfirm(e)})}bulkCancel(){let e=this.filteredReservations.filter(i=>this.selection.has(i.id)&&(i.status===S.PENDING||i.status===S.CONFIRMED));if(e.length===0){this.snackBar.open("No cancellable bookings selected","Close",{duration:3e3});return}this.popupService.confirmDanger(`Cancel ${e.length} booking(s)? This action cannot be undone.`,"Bulk Cancel Bookings").subscribe(i=>{i&&this.processBulkCancel(e)})}processBulkConfirm(e){this.isLoading=!0;let i=0,o=0,m=e.map(d=>Ee(this.bookingService.updateBooking(d.id,{status:S.CONFIRMED,updatedAt:new Date})));Promise.allSettled(m).then(d=>{d.forEach(h=>{h.status==="fulfilled"?i++:o++}),this.isLoading=!1,this.selection.clear(),this.selectedCount=0,this.isAllSelected=!1,i>0&&(this.snackBar.open(`${i} booking(s) confirmed successfully`,"Close",{duration:3e3}),this.loadReservations()),o>0&&this.snackBar.open(`${o} booking(s) failed to confirm`,"Close",{duration:3e3})})}processBulkCancel(e){this.isLoading=!0;let i=0,o=0,m=e.map(d=>Ee(this.bookingService.cancelBooking(d.id,"Bulk cancelled by admin")));Promise.allSettled(m).then(d=>{d.forEach(h=>{h.status==="fulfilled"?i++:o++}),this.isLoading=!1,this.selection.clear(),this.selectedCount=0,this.isAllSelected=!1,i>0&&(this.snackBar.open(`${i} booking(s) cancelled successfully`,"Close",{duration:3e3}),this.loadReservations()),o>0&&this.snackBar.open(`${o} booking(s) failed to cancel`,"Close",{duration:3e3})})}updateSelectionCount(){this.selectedCount=this.selection.size,this.isAllSelected=this.selectedCount>0&&this.selectedCount===this.filteredReservations.filter(e=>this.canSelect(e)).length}onSelectionChange(e,i){i?this.selection.set(e,!0):this.selection.delete(e),this.updateSelectionCount()}exportToCSV(){if(this.filteredReservations.length===0){this.snackBar.open("No reservations to export","Close",{duration:3e3});return}let i=[["Booking ID","Customer ID","Room ID","Check-in Date","Check-out Date","Guests","Status","Payment Status","Total Amount","Special Requests","Created Date"].join(","),...this.filteredReservations.map(h=>[h.id,h.customerId,h.roomId,h.checkInDate.toISOString().split("T")[0],h.checkOutDate.toISOString().split("T")[0],h.guests,h.status,h.paymentStatus,h.totalAmount,`"${(h.specialRequests||"").replace(/"/g,'""')}"`,h.createdAt.toISOString().split("T")[0]].join(","))].join(`
`),o=new Blob([i],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a"),d=URL.createObjectURL(o);m.setAttribute("href",d),m.setAttribute("download",`reservations_${new Date().toISOString().split("T")[0]}.csv`),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m),this.snackBar.open("CSV exported successfully","Close",{duration:3e3})}};l.\u0275fac=function(i){return new(i||l)(b(we),b(ce),b(vi),b(pe),b(xi))},l.\u0275cmp=L({type:l,selectors:[["app-manage-reservations"]],decls:80,vars:17,consts:[["startPicker",""],["endPicker",""],[1,"manage-reservations-container"],[1,"page-header"],[1,"reservations-overview"],[1,"stats-row"],[1,"stat-item"],[1,"actions-row"],["mat-raised-button","","color","primary",3,"click"],["mat-stroked-button","",3,"click","disabled"],[1,"filters-section"],[1,"filter-form",3,"formGroup"],[1,"filter-row"],["appearance","outline",1,"filter-field"],["formControlName","status"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","paymentStatus"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","endDate",3,"matDatepicker"],["mat-raised-button","","color","accent",3,"click","disabled"],[1,"reservations-table"],["class","loading-section",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","table-container",4,"ngIf"],[3,"value"],[1,"loading-section"],["message","Loading reservations..."],[1,"empty-state"],[1,"table-container"],["class","bulk-actions",4,"ngIf"],["mat-table","",1,"reservations-table",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","customerId"],["matColumnDef","roomId"],["matColumnDef","checkInDate"],["matColumnDef","checkOutDate"],["matColumnDef","guests"],["matColumnDef","status"],["matColumnDef","paymentStatus"],["matColumnDef","totalAmount"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"bulk-actions"],[1,"selected-count"],["mat-raised-button","","color","warn",3,"click"],["mat-header-cell",""],[3,"change","checked","indeterminate"],["mat-cell",""],[3,"click","change","checked","disabled"],[3,"ngClass"],[1,"action-buttons"],["mat-icon-button","","color","primary","matTooltip","View Details",3,"click"],["mat-icon-button","","color","accent","matTooltip","Edit Booking",3,"click"],["mat-icon-button","","color","warn","matTooltip","Cancel Booking",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,o){if(i&1){let m=E();r(0,"div",2)(1,"div",3)(2,"h1"),s(3,"Manage Reservations"),a(),r(4,"p"),s(5,"View and manage all hotel reservations"),a()(),r(6,"mat-card")(7,"mat-card-content")(8,"div",4)(9,"div",5)(10,"div",6)(11,"h3"),s(12),a(),r(13,"p"),s(14,"Active Reservations"),a()(),r(15,"div",6)(16,"h3"),s(17),a(),r(18,"p"),s(19,"Pending"),a()(),r(20,"div",6)(21,"h3"),s(22),a(),r(23,"p"),s(24,"Completed"),a()(),r(25,"div",6)(26,"h3"),s(27),a(),r(28,"p"),s(29,"Cancelled"),a()()(),r(30,"div",7)(31,"button",8),_("click",function(){return g(m),v(o.openNewReservationDialog())}),r(32,"mat-icon"),s(33,"add"),a(),s(34," New Reservation "),a(),r(35,"button",9),_("click",function(){return g(m),v(o.refreshReservations())}),r(36,"mat-icon"),s(37,"refresh"),a(),s(38," Refresh "),a(),r(39,"button",9),_("click",function(){return g(m),v(o.exportToCSV())}),r(40,"mat-icon"),s(41,"download"),a(),s(42," Export CSV "),a()(),r(43,"div",10)(44,"form",11)(45,"div",12)(46,"mat-form-field",13)(47,"mat-label"),s(48,"Status"),a(),r(49,"mat-select",14)(50,"mat-option",15),s(51,"All Statuses"),a(),u(52,vn,3,4,"mat-option",16),a()(),r(53,"mat-form-field",13)(54,"mat-label"),s(55,"Payment Status"),a(),r(56,"mat-select",17)(57,"mat-option",15),s(58,"All Payment Statuses"),a(),u(59,Cn,3,4,"mat-option",16),a()(),r(60,"mat-form-field",13)(61,"mat-label"),s(62,"Start Date"),a(),y(63,"input",18)(64,"mat-datepicker-toggle",19)(65,"mat-datepicker",null,0),a(),r(67,"mat-form-field",13)(68,"mat-label"),s(69,"End Date"),a(),y(70,"input",20)(71,"mat-datepicker-toggle",19)(72,"mat-datepicker",null,1),a(),r(74,"button",21),_("click",function(){return g(m),v(o.applyFilters())}),s(75," Apply Filters "),a()()()()(),r(76,"div",22),u(77,bn,2,0,"div",23)(78,yn,7,0,"div",24)(79,Kn,38,4,"div",25),a()()()()}if(i&2){let m=P(66),d=P(73);c(12),x(o.stats.active),c(5),x(o.stats.pending),c(5),x(o.stats.completed),c(5),x(o.stats.cancelled),c(8),p("disabled",o.isLoading),c(4),p("disabled",o.filteredReservations.length===0),c(5),p("formGroup",o.filterForm),c(8),p("ngForOf",o.bookingStatuses),c(7),p("ngForOf",o.paymentStatuses),c(4),p("matDatepicker",m),c(),p("for",m),c(6),p("matDatepicker",d),c(),p("for",d),c(3),p("disabled",o.isLoading),c(3),p("ngIf",o.isLoading),c(),p("ngIf",!o.isLoading&&o.filteredReservations.length===0),c(),p("ngIf",!o.isLoading&&o.filteredReservations.length>0)}},dependencies:[X,Ct,Y,Q,yt,St,kt,Lt,Ft,Nt,te,ee,It,ie,Tt,fi,ai,si,pi,li,ri,di,ci,mi,ui,hi,be,fe,he,de,ue,ge,_e,Ce,ve,B,Me,ye,Se,ke,Oe,Jt,Xt,xe,Mi,ki,me,re,ne,oe,ae,se,le,wi],styles:[".manage-reservations-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 8px;font-size:32px;font-weight:500}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:16px}.reservations-overview[_ngcontent-%COMP%]{margin-bottom:24px}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;margin-bottom:24px}.stat-item[_ngcontent-%COMP%]{text-align:center;padding:16px;background-color:#f5f5f5;border-radius:8px}.stat-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:24px;font-weight:500;color:#1976d2}.stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:14px}.actions-row[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:24px}.actions-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.filters-section[_ngcontent-%COMP%]{margin-bottom:24px;padding:16px;background-color:#f9f9f9;border-radius:8px}.filter-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.filter-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;flex-wrap:wrap}.filter-field[_ngcontent-%COMP%]{flex:1;min-width:200px}.reservations-table[_ngcontent-%COMP%]{margin-top:24px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.reservations-table[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px}.bulk-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:16px;padding:16px;background-color:#e3f2fd;border-radius:8px;border:1px solid #bbdefb}.selected-count[_ngcontent-%COMP%]{font-weight:500;color:#1976d2}.status-pending[_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.status-confirmed[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.status-checked_in[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1565c0}.status-checked_out[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.status-cancelled[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.payment-pending[_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.payment-paid[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.payment-failed[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.loading-section[_ngcontent-%COMP%]{padding:40px 0;text-align:center}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:24px;font-weight:400}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666}@media (max-width: 768px){.manage-reservations-container[_ngcontent-%COMP%]{padding:16px}.stats-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.actions-row[_ngcontent-%COMP%], .filter-row[_ngcontent-%COMP%]{flex-direction:column}.filter-field[_ngcontent-%COMP%]{min-width:100%}}"]});let n=l;return n})();export{ma as ManageReservationsComponent};
