import{a as ht}from"./chunk-2R3JM6HR.js";import{a as Mt}from"./chunk-LNRUO345.js";import{b as O}from"./chunk-XULBARPE.js";import{g as ft,o as P}from"./chunk-MCWKRJ2W.js";import{d as A,e as R,f as xt,g as B,h as L,i as V,j as $}from"./chunk-DKXMDT6G.js";import{a as st,b as mt,c as rt,d as pt,e as dt,f as ct,g as gt,h as ut,i as Ct,j as _t}from"./chunk-NXT2FNZM.js";import"./chunk-6EN32LWK.js";import{a as it}from"./chunk-HVPW2HUH.js";import"./chunk-RLT2GMJN.js";import"./chunk-5SILISN4.js";import{a as ot,c as lt}from"./chunk-GYQFREEB.js";import"./chunk-6N2D2TM4.js";import"./chunk-5JWQYBSU.js";import{L as nt,S as at,f as tt,i as et}from"./chunk-WLYOVEFQ.js";import"./chunk-VD6NAWDZ.js";import{a as vt}from"./chunk-AXBWI7GR.js";import"./chunk-FJOTTGA4.js";import"./chunk-TWAJJYLZ.js";import"./chunk-V7ARBOJB.js";import{$a as C,Ba as c,Cb as h,Db as U,Eb as S,Ga as w,La as p,T as E,Xa as g,Xb as N,Ya as n,Za as t,Zb as W,_a as D,ab as _,ac as G,bc as k,cb as T,eb as M,fa as b,fb as v,fd as q,g as j,ga as I,kd as y,md as J,od as K,pd as Q,qd as X,rd as Y,tb as e,td as Z,ub as d,vb as u,xa as m,xb as F,yb as z,zb as H}from"./chunk-SYWHXGLG.js";function Et(i,a){i&1&&(n(0,"div",13),D(1,"app-loading-spinner",14),t())}function bt(i,a){i&1&&(n(0,"div",15)(1,"mat-icon"),e(2,"support_agent"),t(),n(3,"h3"),e(4,"No complaints found"),t(),n(5,"p"),e(6,"There are no complaints to display at the moment"),t()())}function It(i,a){i&1&&(n(0,"th",29),e(1,"Complaint ID"),t())}function wt(i,a){if(i&1&&(n(0,"td",30),e(1),t()),i&2){let r=a.$implicit;m(),d(r.complaintId)}}function Dt(i,a){i&1&&(n(0,"th",29),e(1,"Customer ID"),t())}function yt(i,a){if(i&1&&(n(0,"td",30),e(1),t()),i&2){let r=a.$implicit;m(),d(r.customerId)}}function Pt(i,a){i&1&&(n(0,"th",29),e(1,"Description"),t())}function Ot(i,a){if(i&1){let r=T();n(0,"td",30)(1,"div",31)(2,"span",32),e(3),t(),n(4,"button",33),M("click",function(){let s=b(r).$implicit,o=v(2);return I(o.viewFullDescription(s))}),e(5," View Full "),t()()()}if(i&2){let r=a.$implicit;m(3),d(r.description)}}function Tt(i,a){i&1&&(n(0,"th",29),e(1,"Status"),t())}function kt(i,a){if(i&1&&(n(0,"td",30)(1,"span",34),e(2),h(3,"titlecase"),t()()),i&2){let r=a.$implicit;m(),g("ngClass","status-"+r.status.toLowerCase()),m(),u(" ",U(3,2,r.status)," ")}}function At(i,a){i&1&&(n(0,"th",29),e(1,"Created"),t())}function Rt(i,a){if(i&1&&(n(0,"td",30),e(1),h(2,"date"),t()),i&2){let r=a.$implicit;m(),d(S(2,1,r.createdAt,"short"))}}function Bt(i,a){i&1&&(n(0,"th",29),e(1,"Last Updated"),t())}function Lt(i,a){if(i&1&&(n(0,"td",30),e(1),h(2,"date"),t()),i&2){let r=a.$implicit;m(),d(S(2,1,r.updatedAt,"short"))}}function Vt(i,a){i&1&&(n(0,"th",29),e(1,"Actions"),t())}function $t(i,a){if(i&1){let r=T();n(0,"td",30)(1,"div",35)(2,"button",36),M("click",function(){let s=b(r).$implicit,o=v(2);return I(o.updateStatus(s))}),n(3,"mat-icon"),e(4,"update"),t()(),n(5,"button",37),M("click",function(){let s=b(r).$implicit,o=v(2);return I(o.deleteComplaint(s))}),n(6,"mat-icon"),e(7,"delete"),t()()()()}}function jt(i,a){i&1&&D(0,"tr",38)}function Ft(i,a){i&1&&D(0,"tr",39)}function zt(i,a){if(i&1&&(n(0,"div",16)(1,"table",17),C(2,18),p(3,It,2,0,"th",19)(4,wt,2,1,"td",20),_(),C(5,21),p(6,Dt,2,0,"th",19)(7,yt,2,1,"td",20),_(),C(8,22),p(9,Pt,2,0,"th",19)(10,Ot,6,1,"td",20),_(),C(11,23),p(12,Tt,2,0,"th",19)(13,kt,4,4,"td",20),_(),C(14,24),p(15,At,2,0,"th",19)(16,Rt,3,4,"td",20),_(),C(17,25),p(18,Bt,2,0,"th",19)(19,Lt,3,4,"td",20),_(),C(20,26),p(21,Vt,2,0,"th",19)(22,$t,8,0,"td",20),_(),p(23,jt,1,0,"tr",27)(24,Ft,1,0,"tr",28),t()()),i&2){let r=v();m(),g("dataSource",r.complaints),m(22),g("matHeaderRowDef",r.displayedColumns),m(),g("matRowDefColumns",r.displayedColumns)}}var pe=(()=>{let a=class a{constructor(l,s,o,f){this.complaintService=l,this.snackBar=s,this.dialog=o,this.popupService=f,this.complaints=[],this.isLoading=!0,this.displayedColumns=["complaintId","customerId","description","status","createdAt","updatedAt","actions"],this.destroy$=new j}ngOnInit(){this.loadComplaints()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}get activeComplaints(){return this.complaints.filter(l=>l.status===O.ACTIVE).length}get resolvedComplaints(){return this.complaints.filter(l=>l.status===O.RESOLVED).length}get totalComplaints(){return this.complaints.length}loadComplaints(){this.isLoading=!0,this.complaintService.getAllComplaints().pipe(E(this.destroy$)).subscribe({next:l=>{this.complaints=l.sort((s,o)=>new Date(o.updatedAt).getTime()-new Date(s.updatedAt).getTime()),this.isLoading=!1},error:l=>{console.error("Error loading complaints:",l),this.isLoading=!1,this.snackBar.open("Failed to load complaints. Please try again.","Close",{duration:5e3,panelClass:["error-snackbar"]})}})}updateStatus(l){this.dialog.open(Ht,{width:"400px",data:{complaint:l}}).afterClosed().subscribe(o=>{o&&this.complaintService.updateComplaintStatus(l.complaintId,o.status).pipe(E(this.destroy$)).subscribe({next:f=>{let x=this.complaints.findIndex(St=>St.complaintId===l.complaintId);x!==-1&&(this.complaints[x]=f),this.snackBar.open("Complaint status updated successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]})},error:f=>{console.error("Error updating complaint status:",f),this.snackBar.open("Failed to update complaint status. Please try again.","Close",{duration:5e3,panelClass:["error-snackbar"]})}})})}deleteComplaint(l){this.popupService.confirmDanger(`Are you sure you want to delete complaint ${l.complaintId}?`,"Delete Complaint").subscribe(s=>{s&&this.complaintService.deleteComplaint(l.complaintId).pipe(E(this.destroy$)).subscribe({next:()=>{this.complaints=this.complaints.filter(o=>o.complaintId!==l.complaintId),this.snackBar.open("Complaint deleted successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]})},error:o=>{console.error("Error deleting complaint:",o),this.snackBar.open("Failed to delete complaint. Please try again.","Close",{duration:5e3,panelClass:["error-snackbar"]})}})})}viewFullDescription(l){this.dialog.open(Ut,{width:"500px",data:{complaint:l}})}};a.\u0275fac=function(s){return new(s||a)(c(ht),c(it),c(xt),c(Mt))},a.\u0275cmp=w({type:a,selectors:[["app-manage-complaints"]],decls:48,vars:6,consts:[[1,"manage-complaints-container"],[1,"page-header"],[1,"stats-section"],[1,"stat-card"],[1,"stat-content"],[1,"stat-icon"],[1,"stat-details"],[1,"stat-number"],[1,"stat-label"],[1,"complaints-section"],["class","loading-section",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","complaints-table-container",4,"ngIf"],[1,"loading-section"],["message","Loading complaints..."],[1,"empty-state"],[1,"complaints-table-container"],["mat-table","",1,"complaints-table",3,"dataSource"],["matColumnDef","complaintId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","customerId"],["matColumnDef","description"],["matColumnDef","status"],["matColumnDef","createdAt"],["matColumnDef","updatedAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"description-cell"],[1,"description-text"],["mat-button","","color","primary",3,"click"],[1,"status-chip",3,"ngClass"],[1,"action-buttons"],["mat-icon-button","","color","primary","matTooltip","Update Status",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete Complaint",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(s,o){s&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),e(3,"Manage Complaints"),t(),n(4,"p"),e(5,"Monitor and manage customer complaints across the hotel"),t()(),n(6,"div",2)(7,"mat-card",3)(8,"mat-card-content")(9,"div",4)(10,"mat-icon",5),e(11,"report_problem"),t(),n(12,"div",6)(13,"span",7),e(14),t(),n(15,"span",8),e(16,"Active Complaints"),t()()()()(),n(17,"mat-card",3)(18,"mat-card-content")(19,"div",4)(20,"mat-icon",5),e(21,"check_circle"),t(),n(22,"div",6)(23,"span",7),e(24),t(),n(25,"span",8),e(26,"Resolved"),t()()()()(),n(27,"mat-card",3)(28,"mat-card-content")(29,"div",4)(30,"mat-icon",5),e(31,"schedule"),t(),n(32,"div",6)(33,"span",7),e(34),t(),n(35,"span",8),e(36,"Total"),t()()()()()(),n(37,"div",9)(38,"mat-card")(39,"mat-card-header")(40,"mat-card-title"),e(41,"All Complaints"),t(),n(42,"mat-card-subtitle"),e(43,"Manage customer complaints and update their status"),t()(),n(44,"mat-card-content"),p(45,Et,2,0,"div",10)(46,bt,7,0,"div",11)(47,zt,25,3,"div",12),t()()()()),s&2&&(m(14),d(o.activeComplaints),m(10),d(o.resolvedComplaints),m(10),d(o.totalComplaints),m(11),g("ngIf",o.isLoading),m(),g("ngIf",!o.isLoading&&o.complaints.length===0),m(),g("ngIf",!o.isLoading&&o.complaints.length>0))},dependencies:[P,N,W,y,q,J,K,X,Z,Y,Q,st,rt,gt,pt,mt,ut,dt,ct,Ct,_t,ft,G,k,vt],styles:[".manage-complaints-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px}.page-header[_ngcontent-%COMP%]{margin-bottom:32px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 8px;font-size:32px;font-weight:300;color:#333}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:16px}.stats-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:32px}.stat-card[_ngcontent-%COMP%]{text-align:center}.stat-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px}.stat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#1976d2}.stat-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.stat-number[_ngcontent-%COMP%]{font-size:32px;font-weight:500;color:#333;line-height:1}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-top:4px}.complaints-section[_ngcontent-%COMP%]{margin-bottom:24px}.loading-section[_ngcontent-%COMP%]{padding:40px 0;text-align:center}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:80px 20px;color:#666}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:24px;font-weight:400}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.complaints-table-container[_ngcontent-%COMP%]{overflow-x:auto}.complaints-table[_ngcontent-%COMP%]{width:100%}.description-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.description-text[_ngcontent-%COMP%]{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.status-chip[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px;font-weight:500}.status-active[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.status-resolved[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}@media (max-width: 768px){.stats-section[_ngcontent-%COMP%]{grid-template-columns:1fr}.stat-content[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.stat-details[_ngcontent-%COMP%]{align-items:center}}"]});let i=a;return i})(),Ht=(()=>{let a=class a{constructor(l,s){this.dialogRef=l,this.data=s,this.selectedStatus=O.ACTIVE,this.selectedStatus=s.complaint.status}updateStatus(){this.dialogRef.close({status:this.selectedStatus})}};a.\u0275fac=function(s){return new(s||a)(c(A),c(R))},a.\u0275cmp=w({type:a,selectors:[["update-status-dialog"]],decls:24,vars:4,consts:[["mat-dialog-title",""],["appearance","outline",1,"full-width"],[3,"ngModelChange","ngModel"],["value","ACTIVE"],["value","RESOLVED"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(s,o){s&1&&(n(0,"h2",0),e(1,"Update Complaint Status"),t(),n(2,"mat-dialog-content")(3,"p")(4,"strong"),e(5,"Complaint ID:"),t(),e(6),t(),n(7,"p")(8,"strong"),e(9,"Current Status:"),t(),e(10),t(),n(11,"mat-form-field",1)(12,"mat-label"),e(13,"New Status"),t(),n(14,"mat-select",2),H("ngModelChange",function(x){return z(o.selectedStatus,x)||(o.selectedStatus=x),x}),n(15,"mat-option",3),e(16,"Active"),t(),n(17,"mat-option",4),e(18,"Resolved"),t()()()(),n(19,"mat-dialog-actions",5)(20,"button",6),e(21,"Cancel"),t(),n(22,"button",7),M("click",function(){return o.updateStatus()}),e(23," Update Status "),t()()),s&2&&(m(6),u(" ",o.data.complaint.complaintId),m(4),u(" ",o.data.complaint.status),m(4),F("ngModel",o.selectedStatus),m(8),g("disabled",!o.selectedStatus||o.selectedStatus===o.data.complaint.status))},dependencies:[P,tt,et,y,at,nt,lt,ot,B,L,$,V],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-top:16px}mat-dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}"]});let i=a;return i})(),Ut=(()=>{let a=class a{constructor(l,s){this.dialogRef=l,this.data=s}};a.\u0275fac=function(s){return new(s||a)(c(A),c(R))},a.\u0275cmp=w({type:a,selectors:[["view-description-dialog"]],decls:33,vars:12,consts:[["mat-dialog-title",""],[1,"description-section"],[1,"description-text"],["align","end"],["mat-button","","mat-dialog-close",""]],template:function(s,o){s&1&&(n(0,"h2",0),e(1,"Complaint Description"),t(),n(2,"mat-dialog-content")(3,"p")(4,"strong"),e(5,"Complaint ID:"),t(),e(6),t(),n(7,"p")(8,"strong"),e(9,"Customer ID:"),t(),e(10),t(),n(11,"p")(12,"strong"),e(13,"Status:"),t(),e(14),t(),n(15,"p")(16,"strong"),e(17,"Created:"),t(),e(18),h(19,"date"),t(),n(20,"p")(21,"strong"),e(22,"Last Updated:"),t(),e(23),h(24,"date"),t(),n(25,"div",1)(26,"h3"),e(27,"Description:"),t(),n(28,"p",2),e(29),t()()(),n(30,"mat-dialog-actions",3)(31,"button",4),e(32,"Close"),t()()),s&2&&(m(6),u(" ",o.data.complaint.complaintId),m(4),u(" ",o.data.complaint.customerId),m(4),u(" ",o.data.complaint.status),m(4),u(" ",S(19,6,o.data.complaint.createdAt,"medium")),m(5),u(" ",S(24,9,o.data.complaint.updatedAt,"medium")),m(6),d(o.data.complaint.description))},dependencies:[P,y,B,L,$,V,k],styles:[".description-section[_ngcontent-%COMP%]{margin-top:16px}.description-text[_ngcontent-%COMP%]{background:#f5f5f5;padding:16px;border-radius:8px;line-height:1.6;white-space:pre-wrap}mat-dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}"]});let i=a;return i})();export{pe as ManageComplaintsComponent,Ht as UpdateStatusDialog,Ut as ViewDescriptionDialog};
